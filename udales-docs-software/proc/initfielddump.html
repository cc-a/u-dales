<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="TODO:">
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>initfielddump &ndash; uDALES</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">uDALES </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/namelists.html">Namelists</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/dalesurban.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>initfielddump
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.3% of total for procedures.">171 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/modfielddump.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/modfielddump.f90.html'>modfielddump.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/modfielddump.html'>modfielddump</a></li>
            <li class="breadcrumb-item active" aria-current="page">initfielddump</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/initfielddump.html#src">initfielddump</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine initfielddump()  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item">modpois</li>
                  <li class="list-inline-item"><a href='../module/modmpi.html'>modmpi</a></li>
                  <li class="list-inline-item"><a href='../module/modglobal.html'>modglobal</a></li>
                  <li class="list-inline-item"><a href='../module/modstat_nc.html'>modstat_nc</a></li>
                  <li class="list-inline-item"><a href='../module/modibm.html'>modibm</a></li>
                  <li class="list-inline-item"><a href='../module/modfields.html'>modfields</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: proc~~initfielddump~~UsesGraph Pages: 1 -->
<svg id="procinitfielddumpUsesGraph" width="408pt" height="240pt"
 viewBox="0.00 0.00 408.00 240.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~initfielddump~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 236)">
<title>proc~~initfielddump~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-236 404,-236 404,4 -4,4"/>
<!-- proc~initfielddump -->
<g id="proc~~initfielddump~~UsesGraph_node1" class="node">
<title>proc~initfielddump</title>
<polygon fill="none" stroke="black" points="400,-127 317,-127 317,-103 400,-103 400,-127"/>
<text text-anchor="middle" x="358.5" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50">initfielddump</text>
</g>
<!-- modpois -->
<g id="proc~~initfielddump~~UsesGraph_node2" class="node">
<title>modpois</title>
<polygon fill="#337ab7" stroke="#337ab7" points="273,-232 215,-232 215,-208 273,-208 273,-232"/>
<text text-anchor="middle" x="244" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modpois</text>
</g>
<!-- proc~initfielddump&#45;&gt;modpois -->
<g id="proc~~initfielddump~~UsesGraph_edge1" class="edge">
<title>proc~initfielddump&#45;&gt;modpois</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M348.35,-127.2C334.92,-144.58 308.45,-176.8 281,-199 279.65,-200.09 278.23,-201.17 276.77,-202.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="274.58,-199.47 268.16,-207.9 278.44,-205.31 274.58,-199.47"/>
</g>
<!-- module~modfields -->
<g id="proc~~initfielddump~~UsesGraph_node3" class="node">
<title>module~modfields</title>
<g id="a_proc~~initfielddump~~UsesGraph_node3"><a xlink:href="../module/modfields.html" xlink:title="modfields">
<polygon fill="#337ab7" stroke="#337ab7" points="276.5,-190 211.5,-190 211.5,-166 276.5,-166 276.5,-190"/>
<text text-anchor="middle" x="244" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modfields</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;module~modfields -->
<g id="proc~~initfielddump~~UsesGraph_edge2" class="edge">
<title>proc~initfielddump&#45;&gt;module~modfields</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335.81,-127.15C318.69,-136.73 294.6,-150.23 275.53,-160.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.64,-157.95 266.62,-165.89 277.06,-164.06 273.64,-157.95"/>
</g>
<!-- module~modglobal -->
<g id="proc~~initfielddump~~UsesGraph_node4" class="node">
<title>module~modglobal</title>
<g id="a_proc~~initfielddump~~UsesGraph_node4"><a xlink:href="../module/modglobal.html" xlink:title="modglobal">
<polygon fill="#337ab7" stroke="#337ab7" points="279,-148 209,-148 209,-124 279,-124 279,-148"/>
<text text-anchor="middle" x="244" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modglobal</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;module~modglobal -->
<g id="proc~~initfielddump~~UsesGraph_edge3" class="edge">
<title>proc~initfielddump&#45;&gt;module~modglobal</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M316.88,-122.58C307.92,-124.25 298.38,-126.03 289.28,-127.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.44,-124.33 279.25,-129.61 289.72,-131.21 288.44,-124.33"/>
</g>
<!-- module~modibm -->
<g id="proc~~initfielddump~~UsesGraph_node5" class="node">
<title>module~modibm</title>
<g id="a_proc~~initfielddump~~UsesGraph_node5"><a xlink:href="../module/modibm.html" xlink:title="modibm">
<polygon fill="#337ab7" stroke="#337ab7" points="272.5,-106 215.5,-106 215.5,-82 272.5,-82 272.5,-106"/>
<text text-anchor="middle" x="244" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modibm</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;module~modibm -->
<g id="proc~~initfielddump~~UsesGraph_edge4" class="edge">
<title>proc~initfielddump&#45;&gt;module~modibm</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M316.88,-107.42C305.72,-105.34 293.67,-103.09 282.68,-101.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.01,-97.54 272.54,-99.14 281.73,-104.42 283.01,-97.54"/>
</g>
<!-- module~modmpi -->
<g id="proc~~initfielddump~~UsesGraph_node6" class="node">
<title>module~modmpi</title>
<g id="a_proc~~initfielddump~~UsesGraph_node6"><a xlink:href="../module/modmpi.html" xlink:title="modmpi">
<polygon fill="#337ab7" stroke="#337ab7" points="159,-66 102,-66 102,-42 159,-42 159,-66"/>
<text text-anchor="middle" x="130.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modmpi</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;module~modmpi -->
<g id="proc~~initfielddump~~UsesGraph_edge5" class="edge">
<title>proc~initfielddump&#45;&gt;module~modmpi</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M340.13,-102.97C325.16,-93.24 302.61,-80.02 281,-73 244.27,-61.06 200.2,-56.58 169.46,-54.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.33,-51.4 159.18,-54.44 169.01,-58.4 169.33,-51.4"/>
</g>
<!-- module~modstat_nc -->
<g id="proc~~initfielddump~~UsesGraph_node7" class="node">
<title>module~modstat_nc</title>
<g id="a_proc~~initfielddump~~UsesGraph_node7"><a xlink:href="../module/modstat_nc.html" xlink:title="modstat_nc">
<polygon fill="#337ab7" stroke="#337ab7" points="281,-26 207,-26 207,-2 281,-2 281,-26"/>
<text text-anchor="middle" x="244" y="-11.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstat_nc</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;module~modstat_nc -->
<g id="proc~~initfielddump~~UsesGraph_edge6" class="edge">
<title>proc~initfielddump&#45;&gt;module~modstat_nc</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M346.1,-102.73C331.58,-87.39 305.46,-60.62 281,-40 277.91,-37.39 274.57,-34.76 271.21,-32.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.11,-29.27 262.98,-26.18 268.97,-34.92 273.11,-29.27"/>
</g>
<!-- decomp_2d -->
<g id="proc~~initfielddump~~UsesGraph_node8" class="node">
<title>decomp_2d</title>
<polygon fill="#337ab7" stroke="#337ab7" points="168,-190 93,-190 93,-166 168,-166 168,-190"/>
<text text-anchor="middle" x="130.5" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">decomp_2d</text>
</g>
<!-- module~modfields&#45;&gt;decomp_2d -->
<g id="proc~~initfielddump~~UsesGraph_edge7" class="edge">
<title>module~modfields&#45;&gt;decomp_2d</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M211.35,-178C201.09,-178 189.49,-178 178.38,-178"/>
<polygon fill="#ffff00" stroke="#ffff00" points="178.36,-174.5 168.36,-178 178.36,-181.5 178.36,-174.5"/>
</g>
<!-- module~modibmdata -->
<g id="proc~~initfielddump~~UsesGraph_node9" class="node">
<title>module~modibmdata</title>
<g id="a_proc~~initfielddump~~UsesGraph_node9"><a xlink:href="../module/modibmdata.html" xlink:title="modibmdata">
<polygon fill="#337ab7" stroke="#337ab7" points="171,-146 90,-146 90,-122 171,-122 171,-146"/>
<text text-anchor="middle" x="130.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modibmdata</text>
</a>
</g>
</g>
<!-- module~modibm&#45;&gt;module~modibmdata -->
<g id="proc~~initfielddump~~UsesGraph_edge8" class="edge">
<title>module~modibm&#45;&gt;module~modibmdata</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M215.44,-103.89C203.19,-108.28 188.48,-113.56 174.82,-118.46"/>
<polygon fill="#00ffff" stroke="#00ffff" points="173.34,-115.27 165.11,-121.94 175.7,-121.86 173.34,-115.27"/>
</g>
<!-- mpi -->
<g id="proc~~initfielddump~~UsesGraph_node10" class="node">
<title>mpi</title>
<g id="a_proc~~initfielddump~~UsesGraph_node10"><a xlink:href="http://www.mpi-forum.org/docs/mpi-3.1/mpi31-report/node410.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="54,-86 0,-86 0,-62 54,-62 54,-86"/>
<text text-anchor="middle" x="27" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi</text>
</a>
</g>
</g>
<!-- module~modibm&#45;&gt;mpi -->
<g id="proc~~initfielddump~~UsesGraph_edge9" class="edge">
<title>module~modibm&#45;&gt;mpi</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M215.33,-91.43C176.78,-87.84 106.83,-81.33 64.18,-77.37"/>
<polygon fill="#00ffff" stroke="#00ffff" points="64.5,-73.88 54.22,-76.44 63.85,-80.85 64.5,-73.88"/>
</g>
<!-- module~modmpi&#45;&gt;mpi -->
<g id="proc~~initfielddump~~UsesGraph_edge10" class="edge">
<title>module~modmpi&#45;&gt;mpi</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M101.76,-59.47C90.21,-61.74 76.63,-64.42 64.3,-66.85"/>
<polygon fill="#0000ff" stroke="#0000ff" points="63.44,-63.45 54.3,-68.82 64.79,-70.32 63.44,-63.45"/>
</g>
<!-- module~modstat_nc&#45;&gt;module~modmpi -->
<g id="proc~~initfielddump~~UsesGraph_edge11" class="edge">
<title>module~modstat_nc&#45;&gt;module~modmpi</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M209.55,-26C196.77,-30.59 182.12,-35.84 168.99,-40.55"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="167.53,-37.36 159.3,-44.03 169.89,-43.95 167.53,-37.36"/>
</g>
<!-- netcdf -->
<g id="proc~~initfielddump~~UsesGraph_node11" class="node">
<title>netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="157.5,-24 103.5,-24 103.5,0 157.5,0 157.5,-24"/>
<text text-anchor="middle" x="130.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">netcdf</text>
</g>
<!-- module~modstat_nc&#45;&gt;netcdf -->
<g id="proc~~initfielddump~~UsesGraph_edge12" class="edge">
<title>module~modstat_nc&#45;&gt;netcdf</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M206.8,-13.35C194.28,-13.13 180.26,-12.87 167.73,-12.65"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="167.7,-9.15 157.64,-12.47 167.57,-16.15 167.7,-9.15"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>




    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: proc~~initfielddump~~CallsGraph Pages: 1 -->
<svg id="procinitfielddumpCallsGraph" width="526pt" height="620pt"
 viewBox="0.00 0.00 526.00 620.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~initfielddump~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 616)">
<title>proc~~initfielddump~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-616 522,-616 522,4 -4,4"/>
<!-- proc~initfielddump -->
<g id="proc~~initfielddump~~CallsGraph_node1" class="node">
<title>proc~initfielddump</title>
<polygon fill="none" stroke="black" points="83,-381 0,-381 0,-357 83,-357 83,-381"/>
<text text-anchor="middle" x="41.5" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50">initfielddump</text>
</g>
<!-- mpi_bcast -->
<g id="proc~~initfielddump~~CallsGraph_node2" class="node">
<title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="206,-486 139,-486 139,-462 206,-462 206,-486"/>
<text text-anchor="middle" x="172.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~initfielddump&#45;&gt;mpi_bcast -->
<g id="proc~~initfielddump~~CallsGraph_edge1" class="edge">
<title>proc~initfielddump&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#ff0000" d="M50.8,-381.17C63.57,-399.09 89.66,-432.66 119,-453 122.31,-455.29 125.9,-457.39 129.61,-459.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="128.41,-462.6 138.95,-463.64 131.36,-456.25 128.41,-462.6"/>
</g>
<!-- proc~define_nc -->
<g id="proc~~initfielddump~~CallsGraph_node3" class="node">
<title>proc~define_nc</title>
<g id="a_proc~~initfielddump~~CallsGraph_node3"><a xlink:href="../proc/define_nc.html" xlink:title="define_nc">
<polygon fill="#d9534f" stroke="#d9534f" points="204.5,-444 140.5,-444 140.5,-420 204.5,-420 204.5,-444"/>
<text text-anchor="middle" x="172.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">define_nc</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;proc~define_nc -->
<g id="proc~~initfielddump~~CallsGraph_edge2" class="edge">
<title>proc~initfielddump&#45;&gt;proc~define_nc</title>
<path fill="none" stroke="#ff0000" d="M67.37,-381.15C87.36,-390.91 115.64,-404.72 137.68,-415.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="136.18,-418.65 146.7,-419.89 139.25,-412.36 136.18,-418.65"/>
</g>
<!-- proc~ncinfo -->
<g id="proc~~initfielddump~~CallsGraph_node4" class="node">
<title>proc~ncinfo</title>
<g id="a_proc~~initfielddump~~CallsGraph_node4"><a xlink:href="../proc/ncinfo.html" xlink:title="ncinfo">
<polygon fill="#d9534f" stroke="#d9534f" points="199.5,-381 145.5,-381 145.5,-357 199.5,-357 199.5,-381"/>
<text text-anchor="middle" x="172.5" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncinfo</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;proc~ncinfo -->
<g id="proc~~initfielddump~~CallsGraph_edge3" class="edge">
<title>proc~initfielddump&#45;&gt;proc~ncinfo</title>
<path fill="none" stroke="#ff0000" d="M83.32,-369C99.91,-369 118.93,-369 135.04,-369"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.16,-372.5 145.16,-369 135.16,-365.5 135.16,-372.5"/>
</g>
<!-- proc~open_nc -->
<g id="proc~~initfielddump~~CallsGraph_node5" class="node">
<title>proc~open_nc</title>
<g id="a_proc~~initfielddump~~CallsGraph_node5"><a xlink:href="../proc/open_nc.html" xlink:title="open_nc">
<polygon fill="#d9534f" stroke="#d9534f" points="201.5,-318 143.5,-318 143.5,-294 201.5,-294 201.5,-318"/>
<text text-anchor="middle" x="172.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">open_nc</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;proc~open_nc -->
<g id="proc~~initfielddump~~CallsGraph_edge4" class="edge">
<title>proc~initfielddump&#45;&gt;proc~open_nc</title>
<path fill="none" stroke="#ff0000" d="M67.37,-356.85C87.36,-347.09 115.64,-333.28 137.68,-322.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.25,-325.64 146.7,-318.11 136.18,-319.35 139.25,-325.64"/>
</g>
<!-- proc~writestat_dims_nc -->
<g id="proc~~initfielddump~~CallsGraph_node6" class="node">
<title>proc~writestat_dims_nc</title>
<g id="a_proc~~initfielddump~~CallsGraph_node6"><a xlink:href="../proc/writestat_dims_nc.html" xlink:title="writestat_dims_nc">
<polygon fill="#d9534f" stroke="#d9534f" points="226,-171 119,-171 119,-147 226,-147 226,-171"/>
<text text-anchor="middle" x="172.5" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">writestat_dims_nc</text>
</a>
</g>
</g>
<!-- proc~initfielddump&#45;&gt;proc~writestat_dims_nc -->
<g id="proc~~initfielddump~~CallsGraph_edge5" class="edge">
<title>proc~initfielddump&#45;&gt;proc~writestat_dims_nc</title>
<path fill="none" stroke="#ff0000" d="M49.99,-356.8C71.23,-322.22 132.02,-223.26 158.7,-179.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.73,-181.58 163.99,-171.23 155.77,-177.92 161.73,-181.58"/>
</g>
<!-- nf90_def_var -->
<g id="proc~~initfielddump~~CallsGraph_node9" class="node">
<title>nf90_def_var</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-402 290.5,-402 290.5,-378 372.5,-378 372.5,-402"/>
<text text-anchor="middle" x="331.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_def_var</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_def_var -->
<g id="proc~~initfielddump~~CallsGraph_edge6" class="edge">
<title>proc~define_nc&#45;&gt;nf90_def_var</title>
<path fill="none" stroke="#cbff00" d="M204.52,-423.7C226.21,-417.9 255.66,-410.02 280.63,-403.34"/>
<polygon fill="#cbff00" stroke="#cbff00" points="281.55,-406.72 290.31,-400.75 279.74,-399.96 281.55,-406.72"/>
</g>
<!-- nf90_enddef -->
<g id="proc~~initfielddump~~CallsGraph_node10" class="node">
<title>nf90_enddef</title>
<polygon fill="#777777" stroke="#777777" points="371,-528 292,-528 292,-504 371,-504 371,-528"/>
<text text-anchor="middle" x="331.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_enddef</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_enddef -->
<g id="proc~~initfielddump~~CallsGraph_edge7" class="edge">
<title>proc~define_nc&#45;&gt;nf90_enddef</title>
<path fill="none" stroke="#cbff00" d="M204.77,-441.65C212.09,-444.66 219.61,-448.43 226,-453 245.99,-467.31 241.43,-481.53 262,-495 268.15,-499.03 275.12,-502.32 282.19,-504.99"/>
<polygon fill="#cbff00" stroke="#cbff00" points="281.24,-508.37 291.84,-508.27 283.49,-501.74 281.24,-508.37"/>
</g>
<!-- nf90_inq_dimid -->
<g id="proc~~initfielddump~~CallsGraph_node12" class="node">
<title>nf90_inq_dimid</title>
<polygon fill="#777777" stroke="#777777" points="378.5,-486 284.5,-486 284.5,-462 378.5,-462 378.5,-486"/>
<text text-anchor="middle" x="331.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_inq_dimid</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_inq_dimid -->
<g id="proc~~initfielddump~~CallsGraph_edge8" class="edge">
<title>proc~define_nc&#45;&gt;nf90_inq_dimid</title>
<path fill="none" stroke="#cbff00" d="M204.52,-440.3C224.86,-445.74 252.02,-453 275.91,-459.4"/>
<polygon fill="#cbff00" stroke="#cbff00" points="275.01,-462.78 285.57,-461.98 276.82,-456.02 275.01,-462.78"/>
</g>
<!-- nf90_inq_varid -->
<g id="proc~~initfielddump~~CallsGraph_node13" class="node">
<title>nf90_inq_varid</title>
<polygon fill="#777777" stroke="#777777" points="377,-276 286,-276 286,-252 377,-252 377,-276"/>
<text text-anchor="middle" x="331.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_inq_varid</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_inq_varid -->
<g id="proc~~initfielddump~~CallsGraph_edge9" class="edge">
<title>proc~define_nc&#45;&gt;nf90_inq_varid</title>
<path fill="none" stroke="#cbff00" d="M193.56,-419.99C204.48,-412.55 217.47,-402.12 226,-390 254.39,-349.65 226.55,-319.31 262,-285 266.24,-280.9 271.25,-277.6 276.62,-274.94"/>
<polygon fill="#cbff00" stroke="#cbff00" points="278.03,-278.14 285.89,-271.04 275.32,-271.69 278.03,-278.14"/>
</g>
<!-- nf90_put_att -->
<g id="proc~~initfielddump~~CallsGraph_node17" class="node">
<title>nf90_put_att</title>
<polygon fill="#777777" stroke="#777777" points="371,-444 292,-444 292,-420 371,-420 371,-444"/>
<text text-anchor="middle" x="331.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_put_att</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_put_att -->
<g id="proc~~initfielddump~~CallsGraph_edge10" class="edge">
<title>proc~define_nc&#45;&gt;nf90_put_att</title>
<path fill="none" stroke="#cbff00" d="M204.52,-432C226.51,-432 256.47,-432 281.65,-432"/>
<polygon fill="#cbff00" stroke="#cbff00" points="281.75,-435.5 291.75,-432 281.75,-428.5 281.75,-435.5"/>
</g>
<!-- nf90_redef -->
<g id="proc~~initfielddump~~CallsGraph_node19" class="node">
<title>nf90_redef</title>
<polygon fill="#777777" stroke="#777777" points="366.5,-570 296.5,-570 296.5,-546 366.5,-546 366.5,-570"/>
<text text-anchor="middle" x="331.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_redef</text>
</g>
<!-- proc~define_nc&#45;&gt;nf90_redef -->
<g id="proc~~initfielddump~~CallsGraph_edge11" class="edge">
<title>proc~define_nc&#45;&gt;nf90_redef</title>
<path fill="none" stroke="#cbff00" d="M204.76,-439.9C212.42,-443 220.1,-447.24 226,-453 255.07,-481.37 231.78,-509.86 262,-537 268.93,-543.23 277.67,-547.61 286.57,-550.69"/>
<polygon fill="#cbff00" stroke="#cbff00" points="285.62,-554.06 296.21,-553.55 287.62,-547.35 285.62,-554.06"/>
</g>
<!-- proc~nchandle_error -->
<g id="proc~~initfielddump~~CallsGraph_node21" class="node">
<title>proc~nchandle_error</title>
<g id="a_proc~~initfielddump~~CallsGraph_node21"><a xlink:href="../proc/nchandle_error.html" xlink:title="nchandle_error">
<polygon fill="#d9534f" stroke="#d9534f" points="378.5,-612 284.5,-612 284.5,-588 378.5,-588 378.5,-612"/>
<text text-anchor="middle" x="331.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nchandle_error</text>
</a>
</g>
</g>
<!-- proc~define_nc&#45;&gt;proc~nchandle_error -->
<g id="proc~~initfielddump~~CallsGraph_edge12" class="edge">
<title>proc~define_nc&#45;&gt;proc~nchandle_error</title>
<path fill="none" stroke="#cbff00" d="M204.72,-439.19C212.56,-442.31 220.34,-446.73 226,-453 265.03,-496.23 221.21,-537.42 262,-579 265.72,-582.79 270.09,-585.9 274.81,-588.45"/>
<polygon fill="#cbff00" stroke="#cbff00" points="273.67,-591.77 284.22,-592.7 276.55,-585.39 273.67,-591.77"/>
</g>
<!-- nf90_create -->
<g id="proc~~initfielddump~~CallsGraph_node7" class="node">
<title>nf90_create</title>
<polygon fill="#777777" stroke="#777777" points="369.5,-234 293.5,-234 293.5,-210 369.5,-210 369.5,-234"/>
<text text-anchor="middle" x="331.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_create</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_create -->
<g id="proc~~initfielddump~~CallsGraph_edge13" class="edge">
<title>proc~open_nc&#45;&gt;nf90_create</title>
<path fill="none" stroke="#0066ff" d="M187.61,-293.75C204.35,-279.76 233.58,-257.01 262,-243 268.83,-239.63 276.3,-236.68 283.73,-234.13"/>
<polygon fill="#0066ff" stroke="#0066ff" points="284.96,-237.41 293.4,-231.01 282.81,-230.75 284.96,-237.41"/>
</g>
<!-- nf90_def_dim -->
<g id="proc~~initfielddump~~CallsGraph_node8" class="node">
<title>nf90_def_dim</title>
<polygon fill="#777777" stroke="#777777" points="374,-192 289,-192 289,-168 374,-168 374,-192"/>
<text text-anchor="middle" x="331.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_def_dim</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_def_dim -->
<g id="proc~~initfielddump~~CallsGraph_edge14" class="edge">
<title>proc~open_nc&#45;&gt;nf90_def_dim</title>
<path fill="none" stroke="#0066ff" d="M180.37,-293.99C193.44,-272.2 224.01,-226.11 262,-201 267.31,-197.49 273.24,-194.54 279.32,-192.08"/>
<polygon fill="#0066ff" stroke="#0066ff" points="280.74,-195.29 288.94,-188.58 278.35,-188.71 280.74,-195.29"/>
</g>
<!-- proc~open_nc&#45;&gt;nf90_def_var -->
<g id="proc~~initfielddump~~CallsGraph_edge15" class="edge">
<title>proc~open_nc&#45;&gt;nf90_def_var</title>
<path fill="none" stroke="#0066ff" d="M187.61,-318.25C204.35,-332.24 233.58,-354.99 262,-369 267.78,-371.85 274.03,-374.41 280.33,-376.68"/>
<polygon fill="#0066ff" stroke="#0066ff" points="279.59,-380.12 290.18,-380 281.82,-373.49 279.59,-380.12"/>
</g>
<!-- proc~open_nc&#45;&gt;nf90_enddef -->
<g id="proc~~initfielddump~~CallsGraph_edge16" class="edge">
<title>proc~open_nc&#45;&gt;nf90_enddef</title>
<path fill="none" stroke="#0066ff" d="M194.51,-318.08C205.45,-325.4 218.15,-335.7 226,-348 262.19,-404.7 215.82,-446.09 262,-495 267.52,-500.85 274.63,-505.08 282.17,-508.15"/>
<polygon fill="#0066ff" stroke="#0066ff" points="281.26,-511.54 291.85,-511.43 283.51,-504.91 281.26,-511.54"/>
</g>
<!-- nf90_get_var -->
<g id="proc~~initfielddump~~CallsGraph_node11" class="node">
<title>nf90_get_var</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-150 290.5,-150 290.5,-126 372.5,-126 372.5,-150"/>
<text text-anchor="middle" x="331.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_get_var</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_get_var -->
<g id="proc~~initfielddump~~CallsGraph_edge17" class="edge">
<title>proc~open_nc&#45;&gt;nf90_get_var</title>
<path fill="none" stroke="#0066ff" d="M177.47,-293.66C187.17,-265.46 214.82,-195.86 262,-159 267.53,-154.68 273.95,-151.24 280.61,-148.51"/>
<polygon fill="#0066ff" stroke="#0066ff" points="282.2,-151.66 290.44,-144.99 279.84,-145.07 282.2,-151.66"/>
</g>
<!-- proc~open_nc&#45;&gt;nf90_inq_dimid -->
<g id="proc~~initfielddump~~CallsGraph_edge18" class="edge">
<title>proc~open_nc&#45;&gt;nf90_inq_dimid</title>
<path fill="none" stroke="#0066ff" d="M193.56,-318.01C204.48,-325.45 217.47,-335.88 226,-348 254.39,-388.35 226.55,-418.69 262,-453 265.81,-456.69 270.26,-459.73 275.02,-462.24"/>
<polygon fill="#0066ff" stroke="#0066ff" points="273.91,-465.58 284.47,-466.44 276.75,-459.18 273.91,-465.58"/>
</g>
<!-- proc~open_nc&#45;&gt;nf90_inq_varid -->
<g id="proc~~initfielddump~~CallsGraph_edge19" class="edge">
<title>proc~open_nc&#45;&gt;nf90_inq_varid</title>
<path fill="none" stroke="#0066ff" d="M201.57,-298.49C222.2,-292.97 250.9,-285.29 275.98,-278.58"/>
<polygon fill="#0066ff" stroke="#0066ff" points="277,-281.94 285.75,-275.97 275.19,-275.17 277,-281.94"/>
</g>
<!-- nf90_inquire -->
<g id="proc~~initfielddump~~CallsGraph_node14" class="node">
<title>nf90_inquire</title>
<polygon fill="#777777" stroke="#777777" points="371,-108 292,-108 292,-84 371,-84 371,-108"/>
<text text-anchor="middle" x="331.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_inquire</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_inquire -->
<g id="proc~~initfielddump~~CallsGraph_edge20" class="edge">
<title>proc~open_nc&#45;&gt;nf90_inquire</title>
<path fill="none" stroke="#0066ff" d="M178.45,-293.99C194.87,-254.4 247.3,-129.77 262,-117 267.75,-112.01 274.66,-108.2 281.85,-105.3"/>
<polygon fill="#0066ff" stroke="#0066ff" points="283.44,-108.46 291.75,-101.88 281.16,-101.84 283.44,-108.46"/>
</g>
<!-- nf90_inquire_dimension -->
<g id="proc~~initfielddump~~CallsGraph_node15" class="node">
<title>nf90_inquire_dimension</title>
<polygon fill="#777777" stroke="#777777" points="401,-66 262,-66 262,-42 401,-42 401,-66"/>
<text text-anchor="middle" x="331.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_inquire_dimension</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_inquire_dimension -->
<g id="proc~~initfielddump~~CallsGraph_edge21" class="edge">
<title>proc~open_nc&#45;&gt;nf90_inquire_dimension</title>
<path fill="none" stroke="#0066ff" d="M178.83,-293.94C188.62,-271.63 209.95,-222.32 226,-180 243.5,-133.87 226.55,-109.31 262,-75 263.26,-73.78 264.59,-72.63 265.97,-71.55"/>
<polygon fill="#0066ff" stroke="#0066ff" points="267.97,-74.43 274.46,-66.05 264.17,-68.55 267.97,-74.43"/>
</g>
<!-- nf90_open -->
<g id="proc~~initfielddump~~CallsGraph_node16" class="node">
<title>nf90_open</title>
<polygon fill="#777777" stroke="#777777" points="366,-360 297,-360 297,-336 366,-336 366,-360"/>
<text text-anchor="middle" x="331.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_open</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_open -->
<g id="proc~~initfielddump~~CallsGraph_edge22" class="edge">
<title>proc~open_nc&#45;&gt;nf90_open</title>
<path fill="none" stroke="#0066ff" d="M201.57,-313.51C225.37,-319.88 259.9,-329.11 287.23,-336.43"/>
<polygon fill="#0066ff" stroke="#0066ff" points="286.38,-339.82 296.95,-339.02 288.19,-333.06 286.38,-339.82"/>
</g>
<!-- proc~open_nc&#45;&gt;nf90_put_att -->
<g id="proc~~initfielddump~~CallsGraph_edge23" class="edge">
<title>proc~open_nc&#45;&gt;nf90_put_att</title>
<path fill="none" stroke="#0066ff" d="M191.97,-318.13C202.75,-325.82 216.14,-336.47 226,-348 246.96,-372.51 236.81,-390.86 262,-411 267.88,-415.7 274.8,-419.35 281.95,-422.19"/>
<polygon fill="#0066ff" stroke="#0066ff" points="281.17,-425.62 291.76,-425.57 283.45,-419 281.17,-425.62"/>
</g>
<!-- nf90_sync -->
<g id="proc~~initfielddump~~CallsGraph_node20" class="node">
<title>nf90_sync</title>
<polygon fill="#777777" stroke="#777777" points="364.5,-318 298.5,-318 298.5,-294 364.5,-294 364.5,-318"/>
<text text-anchor="middle" x="331.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_sync</text>
</g>
<!-- proc~open_nc&#45;&gt;nf90_sync -->
<g id="proc~~initfielddump~~CallsGraph_edge24" class="edge">
<title>proc~open_nc&#45;&gt;nf90_sync</title>
<path fill="none" stroke="#0066ff" d="M201.57,-306C225.66,-306 260.73,-306 288.22,-306"/>
<polygon fill="#0066ff" stroke="#0066ff" points="288.34,-309.5 298.34,-306 288.34,-302.5 288.34,-309.5"/>
</g>
<!-- proc~writestat_dims_nc&#45;&gt;nf90_inq_varid -->
<g id="proc~~initfielddump~~CallsGraph_edge25" class="edge">
<title>proc~writestat_dims_nc&#45;&gt;nf90_inq_varid</title>
<path fill="none" stroke="#cc00ff" d="M183.06,-171.13C198.02,-189.31 228.7,-223.56 262,-243 266.45,-245.6 271.26,-247.91 276.18,-249.95"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="275.16,-253.3 285.75,-253.56 277.63,-246.75 275.16,-253.3"/>
</g>
<!-- proc~writestat_dims_nc&#45;&gt;nf90_inquire_dimension -->
<g id="proc~~initfielddump~~CallsGraph_edge26" class="edge">
<title>proc~writestat_dims_nc&#45;&gt;nf90_inquire_dimension</title>
<path fill="none" stroke="#cc00ff" d="M183.06,-146.87C198.02,-128.69 228.7,-94.44 262,-75 265.05,-73.22 268.26,-71.58 271.56,-70.07"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="273.16,-73.19 281.05,-66.13 270.48,-66.73 273.16,-73.19"/>
</g>
<!-- nf90_put_var -->
<g id="proc~~initfielddump~~CallsGraph_node18" class="node">
<title>nf90_put_var</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-24 290.5,-24 290.5,0 372.5,0 372.5,-24"/>
<text text-anchor="middle" x="331.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_put_var</text>
</g>
<!-- proc~writestat_dims_nc&#45;&gt;nf90_put_var -->
<g id="proc~~initfielddump~~CallsGraph_edge27" class="edge">
<title>proc~writestat_dims_nc&#45;&gt;nf90_put_var</title>
<path fill="none" stroke="#cc00ff" d="M178.64,-146.94C189.95,-121.88 219.39,-63.94 262,-33 267.61,-28.92 274.03,-25.63 280.64,-22.97"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="282.13,-26.15 290.38,-19.5 279.78,-19.55 282.13,-26.15"/>
</g>
<!-- nf90_strerror -->
<g id="proc~~initfielddump~~CallsGraph_node22" class="node">
<title>nf90_strerror</title>
<polygon fill="#777777" stroke="#777777" points="518,-612 437,-612 437,-588 518,-588 518,-612"/>
<text text-anchor="middle" x="477.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nf90_strerror</text>
</g>
<!-- proc~nchandle_error&#45;&gt;nf90_strerror -->
<g id="proc~~initfielddump~~CallsGraph_edge28" class="edge">
<title>proc~nchandle_error&#45;&gt;nf90_strerror</title>
<path fill="none" stroke="#ff0066" d="M378.86,-600C393.95,-600 410.78,-600 426.16,-600"/>
<polygon fill="#ff0066" stroke="#ff0066" points="426.53,-603.5 436.53,-600 426.53,-596.5 426.53,-603.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: proc~~initfielddump~~CalledByGraph Pages: 1 -->
<svg id="procinitfielddumpCalledByGraph" width="212pt" height="32pt"
 viewBox="0.00 0.00 212.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~initfielddump~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~initfielddump~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 208,-28 208,4 -4,4"/>
<!-- proc~initfielddump -->
<g id="proc~~initfielddump~~CalledByGraph_node1" class="node">
<title>proc~initfielddump</title>
<polygon fill="none" stroke="black" points="204,-24 121,-24 121,0 204,0 204,-24"/>
<text text-anchor="middle" x="162.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">initfielddump</text>
</g>
<!-- program~dalesurban -->
<g id="proc~~initfielddump~~CalledByGraph_node2" class="node">
<title>program~dalesurban</title>
<g id="a_proc~~initfielddump~~CalledByGraph_node2"><a xlink:href="../program/dalesurban.html" xlink:title="DALESURBAN">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="85,-24 0,-24 0,0 85,0 85,-24"/>
<text text-anchor="middle" x="42.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">DALESURBAN</text>
</a>
</g>
</g>
<!-- program~dalesurban&#45;&gt;proc~initfielddump -->
<g id="proc~~initfielddump~~CalledByGraph_edge1" class="edge">
<title>program~dalesurban&#45;&gt;proc~initfielddump</title>
<path fill="none" stroke="#ff0000" d="M85.1,-12C93.31,-12 102.01,-12 110.49,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="110.67,-15.5 120.67,-12 110.67,-8.5 110.67,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">initfielddump</span>
<span class="w">    </span><span class="k">use </span><span class="n">modmpi</span><span class="p">,</span><span class="w">   </span><span class="k">only</span><span class="w">   </span><span class="p">:</span><span class="n">myid</span><span class="p">,</span><span class="n">my_real</span><span class="p">,</span><span class="n">mpierr</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpi_logical</span><span class="p">,</span><span class="n">mpi_integer</span><span class="p">,</span><span class="n">cmyidx</span><span class="p">,</span><span class="n">cmyidy</span><span class="p">,</span><span class="n">mpi_character</span>
<span class="w">    </span><span class="k">use </span><span class="n">modglobal</span><span class="p">,</span><span class="k">only</span><span class="w">   </span><span class="p">:</span><span class="n">imax</span><span class="p">,</span><span class="n">jmax</span><span class="p">,</span><span class="n">kmax</span><span class="p">,</span><span class="n">imax1</span><span class="p">,</span><span class="n">jmax1</span><span class="p">,</span><span class="n">kmax1</span><span class="p">,</span><span class="n">imax2</span><span class="p">,</span><span class="n">jmax2</span><span class="p">,</span><span class="n">kmax2</span><span class="p">,</span><span class="n">cexpnr</span><span class="p">,</span><span class="n">ifnamopt</span><span class="p">,</span><span class="n">fname_options</span><span class="p">,</span><span class="n">dtmax</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="w"> </span><span class="n">ladaptive</span><span class="p">,</span><span class="n">dt_lim</span><span class="p">,</span><span class="n">btime</span><span class="p">,</span><span class="n">nsv</span><span class="p">,</span><span class="n">fieldvars</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="w"> </span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">lfielddump</span><span class="p">,</span><span class="n">ktot</span><span class="p">,</span><span class="n">kh</span>
<span class="w">    </span><span class="k">use </span><span class="n">modstat_nc</span><span class="p">,</span><span class="k">only</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">open_nc</span><span class="p">,</span><span class="w"> </span><span class="n">define_nc</span><span class="p">,</span><span class="n">ncinfo</span><span class="p">,</span><span class="n">writestat_dims_nc</span>
<span class="w">    </span><span class="k">use </span><span class="n">modfields</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">thl0</span><span class="p">,</span><span class="n">sv0</span><span class="p">,</span><span class="n">ql0</span><span class="p">,</span><span class="n">qt0</span><span class="p">,</span><span class="n">pres0</span><span class="p">,</span><span class="n">div</span><span class="p">,</span><span class="n">dudx</span><span class="p">,</span><span class="n">dvdy</span><span class="p">,</span><span class="n">dwdz</span><span class="p">,</span><span class="n">ru</span><span class="p">,</span><span class="n">rv</span><span class="p">,</span><span class="n">rw</span><span class="p">,</span><span class="n">tau_x</span><span class="p">,</span><span class="w"> </span><span class="n">tau_y</span><span class="p">,</span><span class="w"> </span><span class="n">tau_z</span><span class="p">,</span><span class="w"> </span><span class="n">thl_flux</span>
<span class="w">    </span><span class="k">use </span><span class="n">modpois</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">pup</span><span class="p">,</span><span class="n">pvp</span><span class="p">,</span><span class="n">pwp</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">dpupdx</span><span class="p">,</span><span class="w"> </span><span class="n">dpvpdy</span><span class="p">,</span><span class="w"> </span><span class="n">dpwpdz</span><span class="p">,</span><span class="w"> </span><span class="n">xyzrt</span><span class="p">,</span><span class="w"> </span><span class="n">Fxy</span><span class="p">,</span><span class="w"> </span><span class="n">Fxyz</span>
<span class="w">    </span><span class="k">use </span><span class="n">modibm</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">mask_u</span><span class="p">,</span><span class="w"> </span><span class="n">mask_v</span><span class="p">,</span><span class="w"> </span><span class="n">mask_w</span><span class="p">,</span><span class="w"> </span><span class="n">mask_c</span>
<span class="w">    </span><span class="k">implicit none</span>
<span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>

<span class="w">    </span><span class="c">!type(domainptr), dimension(nvar) :: pfields</span>

<span class="w">    </span><span class="n">nvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">LEN</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">fieldvars</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nvar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">lfielddump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;empty fieldvars therefore lfielddump = .false. and no instantaneous fields outputted&#39;</span>
<span class="w">      </span><span class="k">return</span>
<span class="k">    else</span>
<span class="k">      allocate</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="n">nvar</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="w">    </span><span class="k">end if</span>




<span class="k">    </span><span class="n">lhalos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lhalos</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">ilow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span>
<span class="w">      </span><span class="n">ihigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span>
<span class="w">      </span><span class="n">jlow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span>
<span class="w">      </span><span class="n">jhigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span><span class="o">+</span><span class="n">jh</span>
<span class="w">      </span><span class="n">klow</span><span class="o">=</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span>
<span class="w">      </span><span class="n">khigh</span><span class="o">=</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span>
<span class="w">    </span><span class="k">else</span>
<span class="k">      </span><span class="n">ilow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span>
<span class="w">      </span><span class="n">ihigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span>
<span class="w">      </span><span class="n">jlow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jb</span>
<span class="w">      </span><span class="n">jhigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span>
<span class="w">      </span><span class="n">klow</span><span class="o">=</span><span class="n">kb</span>
<span class="w">      </span><span class="n">khigh</span><span class="o">=</span><span class="n">ke</span>
<span class="w">    </span><span class="k">end if</span>


<span class="c">!ils13 13.08.18: why is this broadcast, doesn&#39;t every processor do it anyway?</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">klow</span><span class="w">        </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">khigh</span><span class="w">       </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">lfielddump</span><span class="w">  </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">ldiracc</span><span class="w">     </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">lbinary</span><span class="w">     </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">ncname</span><span class="w">     </span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="n">MPI_CHARACTER</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">nvar</span><span class="w">       </span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>

<span class="w">    </span><span class="c">!    dt_lim = min(dt_lim,tnext)</span>

<span class="w">    </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">lfielddump</span><span class="p">))</span><span class="w"> </span><span class="k">return</span>

<span class="k">    </span><span class="n">fname</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmyidx</span>
<span class="w">    </span><span class="n">fname</span><span class="p">(</span><span class="mi">15</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmyidy</span>
<span class="w">    </span><span class="n">fname</span><span class="p">(</span><span class="mi">19</span><span class="p">:</span><span class="mi">21</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cexpnr</span>
<span class="w">    </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">tncname</span><span class="p">(</span><span class="mi">1</span><span class="p">,:),</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="w">    </span><span class="c">! tg3315 reads in fields specified by fieldvars</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lhalos</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">    do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvar</span>
<span class="w">      </span><span class="k">select case</span><span class="p">(</span><span class="n">fieldvars</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;u0&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;West-East velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;mttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;v0&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;South-North velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;tmtt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;w0&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;Vertical velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;ttmt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">w0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;thl&#39;</span><span class="p">,</span><span class="s1">&#39;Liquid water potential temperature&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;ql&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;ql&#39;</span><span class="p">,</span><span class="s1">&#39;Liquid water mixing ratio&#39;</span><span class="p">,</span><span class="s1">&#39;1e-5kg/kg&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ql0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;qt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;qt&#39;</span><span class="p">,</span><span class="s1">&#39;Total water mixing ratio&#39;</span><span class="p">,</span><span class="s1">&#39;1e-5kg/kg&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca1&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 1&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca2&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 2&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca3&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 3&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s4&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca4&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 4&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s5&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca5&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 5&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;p0&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;pressure field&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pres0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<span class="w">      </span><span class="c">! case(&#39;pd&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;p&#39;,&#39;pressure correction&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; p(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;pu&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pup&#39;,&#39;predicted u&#39;,&#39;M&#39;,&#39;mttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; pup(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;pv&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pvp&#39;,&#39;predicted v&#39;,&#39;M&#39;,&#39;tmtt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; pvp(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;pw&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pwp&#39;,&#39;predicted w&#39;,&#39;M&#39;,&#39;ttmt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; pwp(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;du&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpupdx&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; dpupdx(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;dv&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpvpdy&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; dpvpdy(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case(&#39;dw&#39;)</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpwpdz&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; dpwpdz(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="c">! case default</span>
<span class="w">      </span><span class="c">!   call ncinfo(ncname( n,:),&#39;u&#39;,&#39;West-East velocity&#39;,&#39;m/s&#39;,&#39;mttt&#39;)</span>
<span class="w">      </span><span class="c">!   pfields(n)%point =&gt; u0(ib-ih:ie+ih,jb-jh:je+jh,kb-kh:ke+kh)</span>
<span class="w">      </span><span class="k">end select</span>
<span class="k">    end do</span>

<span class="k">    else</span>

<span class="k">      do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvar</span>
<span class="w">        </span><span class="k">select case</span><span class="p">(</span><span class="n">fieldvars</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;u0&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;West-East velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;mttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;v0&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;South-North velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;tmtt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;w0&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;Vertical velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;ttmt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">w0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;thl&#39;</span><span class="p">,</span><span class="s1">&#39;Liquid water potential temperature&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;ql&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;ql&#39;</span><span class="p">,</span><span class="s1">&#39;Liquid water mixing ratio&#39;</span><span class="p">,</span><span class="s1">&#39;1e-5kg/kg&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ql0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;qt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;qt&#39;</span><span class="p">,</span><span class="s1">&#39;Total water mixing ratio&#39;</span><span class="p">,</span><span class="s1">&#39;1e-5kg/kg&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca1&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 1&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca2&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 2&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca3&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 3&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s4&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca4&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 4&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;s5&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;sca5&#39;</span><span class="p">,</span><span class="s1">&#39;scalar 5&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;p0&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;pressure field&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pres0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;tx&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;tau_x&#39;</span><span class="p">,</span><span class="s1">&#39;stress x&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;mttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tau_x</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;ty&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;tau_y&#39;</span><span class="p">,</span><span class="s1">&#39;stress y&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tmtt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tau_y</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;tz&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;tau_z&#39;</span><span class="p">,</span><span class="s1">&#39;stress z&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;ttmt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tau_z</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;hf&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;thl_flux&#39;</span><span class="p">,</span><span class="s1">&#39;heat flux&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">thl_flux</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;mask_u&#39;</span><span class="p">,</span><span class="s1">&#39;mask u&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;mttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">mask_u</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;mv&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;mask_v&#39;</span><span class="p">,</span><span class="s1">&#39;mask v&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tmtt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">mask_v</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;mw&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;mask_w&#39;</span><span class="p">,</span><span class="s1">&#39;mask w&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;ttmt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">mask_w</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;mc&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;mask_c&#39;</span><span class="p">,</span><span class="s1">&#39;mask c&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">mask_c</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="c">! case(&#39;pd&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;p&#39;,&#39;pressure correction&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; p(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;pu&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pup&#39;,&#39;predicted u&#39;,&#39;M&#39;,&#39;mttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; pup(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;pv&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pvp&#39;,&#39;predicted v&#39;,&#39;M&#39;,&#39;tmtt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; pvp(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;pw&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;pwp&#39;,&#39;predicted w&#39;,&#39;M&#39;,&#39;ttmt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; pwp(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;rs&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;rhs&#39;,&#39;rhs of poisson equation&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; rhs(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;du&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpupdx&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dpupdx(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;dv&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpvpdy&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dpvpdy(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;dw&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dpwpdz&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dpwpdz(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;di&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;div&#39;</span><span class="p">,</span><span class="s1">&#39;Divergence after pressure correction&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;tttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">div</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="c">! case(&#39;ft&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;ft&#39;,&#39;Fourier transformed data in x and y&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; Fxy(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;ge&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;ge&#39;,&#39;Fourier transformed data in x and y and done GE in z&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; Fxyz(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;ux&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dudx&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dudx(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;vy&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dvdy&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dvdy(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;wz&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;dwdz&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; dwdz(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;up&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;up&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; ru(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;vp&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;vp&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; rv(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;wp&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;wp&#39;,&#39;&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; rw(ib:ie,jb:je,kb:ke)</span>
<span class="w">        </span><span class="c">! case(&#39;rt&#39;)</span>
<span class="w">        </span><span class="c">!   call ncinfo(ncname( n,:),&#39;xyzrt&#39;,&#39;Wavenumbers&#39;,&#39;M&#39;,&#39;tttt&#39;)</span>
<span class="w">        </span><span class="c">!   pfields(n)%point =&gt; xyzrt(1:sp%zsz(1),1:sp%zsz(2),1:ktot)</span>
<span class="w">        </span><span class="k">case </span><span class="n">default</span>
<span class="w">          </span><span class="k">call </span><span class="n">ncinfo</span><span class="p">(</span><span class="n">ncname</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,:),</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;West-East velocity&#39;</span><span class="p">,</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span><span class="s1">&#39;mttt&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="n">pfields</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">point</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<span class="w">        </span><span class="k">end select</span>
<span class="k">      end do</span>

<span class="k">    end if</span>

<span class="w">    </span><span class="c">!call ncinfo(ncname( n,:),&#39;u&#39;,&#39;West-East velocity&#39;,&#39;m/s&#39;,&#39;mttt&#39;)</span>
<span class="w">    </span><span class="c">!call open_nc( fname, ncid, nrec, n1=imax+2, n2=jmax+2, n3=khigh-klow+1)</span>
<span class="w">    </span><span class="k">call </span><span class="n">open_nc</span><span class="p">(</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="n">nrec</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="o">=</span><span class="n">ihigh</span><span class="o">-</span><span class="n">ilow</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="o">=</span><span class="n">jhigh</span><span class="o">-</span><span class="n">jlow</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="o">=</span><span class="n">khigh</span><span class="o">-</span><span class="n">klow</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nrec</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">define_nc</span><span class="p">(</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tncname</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">writestat_dims_nc</span><span class="p">(</span><span class="n">ncid</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    call </span><span class="n">define_nc</span><span class="p">(</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="n">nvar</span><span class="p">,</span><span class="w"> </span><span class="n">ncname</span><span class="p">)</span>
<span class="w">    </span><span class="c">!call open_nc( fname, ncid, nrec, n1=imax+2, n2=jmax+2, n3=khigh-klow+1)</span>
<span class="w">    </span><span class="k">call </span><span class="n">open_nc</span><span class="p">(</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="n">nrec</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="o">=</span><span class="n">ihigh</span><span class="o">-</span><span class="n">ilow</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="o">=</span><span class="n">jhigh</span><span class="o">-</span><span class="n">jlow</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="o">=</span><span class="n">khigh</span><span class="o">-</span><span class="n">klow</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nrec</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">define_nc</span><span class="p">(</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tncname</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">writestat_dims_nc</span><span class="p">(</span><span class="n">ncid</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>
<span class="k">    call </span><span class="n">define_nc</span><span class="p">(</span><span class="w"> </span><span class="n">ncid</span><span class="p">,</span><span class="w"> </span><span class="n">nvar</span><span class="p">,</span><span class="w"> </span><span class="n">ncname</span><span class="p">)</span>

<span class="w">     </span><span class="c">!   ! X-pencil</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!   fname1(11:13) = cmyidx</span>
<span class="w">     </span><span class="c">!   fname1(15:17) = cmyidy</span>
<span class="w">     </span><span class="c">!   fname1(19:21) = cexpnr</span>
<span class="w">     </span><span class="c">!   call ncinfo(tncname1(1,:),&#39;time&#39;,&#39;Time&#39;,&#39;s&#39;,&#39;time&#39;)</span>
<span class="w">     </span><span class="c">!   call ncinfo(ncname1(1,:),&#39;u&#39;,&#39;West-East velocity&#39;,&#39;m/s&#39;,&#39;mttt&#39;)</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!   !write(*,*) &quot;done defining pfields&quot;</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!   call open_nc( fname1, ncid1, nrec, n1=imax1+2, n2=jmax1+2, n3=kmax1+2)</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!   if (nrec==0) then</span>
<span class="w">     </span><span class="c">!     call define_nc( ncid1, 1, tncname1)</span>
<span class="w">     </span><span class="c">!     call writestat_dims_nc(ncid1)</span>
<span class="w">     </span><span class="c">!   end if</span>
<span class="w">     </span><span class="c">!   call define_nc( ncid1, nvar, ncname1)</span>
<span class="w">     </span><span class="c">!   call open_nc( fname1, ncid1, nrec, n1=imax1+2, n2=jmax1+2, n3=kmax1+2)</span>
<span class="w">     </span><span class="c">!   ! call open_nc( fname, ncid, nrec, n1=imax+2, n2=jmax+2, n3=khigh-klow+1)  !if want to print ghostcells</span>
<span class="w">     </span><span class="c">!   if (nrec==0) then</span>
<span class="w">     </span><span class="c">!     call define_nc( ncid1, 1, tncname1)</span>
<span class="w">     </span><span class="c">!     call writestat_dims_nc(ncid1)</span>
<span class="w">     </span><span class="c">!  end if</span>
<span class="w">     </span><span class="c">!  call define_nc( ncid1, nvar, ncname1)</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!  ! Y-pencil</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!  fname2(11:13) = cmyidx</span>
<span class="w">     </span><span class="c">!  fname2(15:17) = cmyidy</span>
<span class="w">     </span><span class="c">!  fname2(19:21) = cexpnr</span>
<span class="w">     </span><span class="c">!  call ncinfo(tncname2(1,:),&#39;time&#39;,&#39;Time&#39;,&#39;s&#39;,&#39;time&#39;)</span>
<span class="w">     </span><span class="c">!  call ncinfo(ncname2( 1,:),&#39;u&#39;,&#39;West-East velocity&#39;,&#39;m/s&#39;,&#39;mttt&#39;)</span>
<span class="w">     </span><span class="c">!</span>
<span class="w">     </span><span class="c">!  call open_nc( fname2, ncid2, nrec, n1=imax2+2, n2=jmax2+2, n3=kmax2+2)</span>
<span class="w">     </span><span class="c">!  if (nrec==0) then</span>
<span class="w">     </span><span class="c">!    call define_nc( ncid2, 1, tncname2)</span>
<span class="w">     </span><span class="c">!    call writestat_dims_nc(ncid2)</span>
<span class="w">     </span><span class="c">!  end if</span>
<span class="w">     </span><span class="c">!  call define_nc( ncid2, nvar, ncname2)</span>
<span class="w">     </span><span class="c">!  call open_nc( fname2, ncid2, nrec, n1=imax2+2, n2=jmax2+2, n3=kmax2+2)</span>
<span class="w">     </span><span class="c">!  ! call open_nc( fname, ncid, nrec, n1=imax+2, n2=jmax+2, n3=khigh-klow+1)  !if want to print ghostcells</span>
<span class="w">     </span><span class="c">!  if (nrec==0) then</span>
<span class="w">     </span><span class="c">!    call define_nc( ncid2, 1, tncname2)</span>
<span class="w">     </span><span class="c">!    call writestat_dims_nc(ncid2)</span>
<span class="w">     </span><span class="c">! end if</span>
<span class="w">     </span><span class="c">! call define_nc( ncid2, nvar, ncname2)</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">initfielddump</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              uDALES
 was developed by The uDALES Team<br>              &copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-08-29 16:19              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>